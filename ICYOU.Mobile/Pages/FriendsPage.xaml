<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ICYOU.Mobile.Pages.FriendsPage"
             Title="Друзья">

    <Grid RowDefinitions="Auto,Auto,*">

        <!-- Add Friend Section -->
        <Frame Grid.Row="0" Margin="10" Padding="10" BorderColor="LightGray">
            <Grid ColumnDefinitions="*,Auto">
                <Entry x:Name="AddFriendBox"
                       Grid.Column="0"
                       Placeholder="Логин пользователя"
                       TextColor="Black"
                       PlaceholderColor="Gray"
                       Margin="0,0,10,0" />
                <Button Grid.Column="1"
                        Text="Добавить"
                        Clicked="OnAddFriendClicked"
                        BackgroundColor="#4CAF50"
                        TextColor="White" />
            </Grid>
        </Frame>

        <!-- Error/Status Text -->
        <Label x:Name="StatusText"
               Grid.Row="1"
               TextColor="Red"
               IsVisible="False"
               FontSize="14"
               Margin="10,5" />

        <!-- Friends List -->
        <CollectionView x:Name="FriendsList"
                        Grid.Row="2">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="10" ColumnDefinitions="50,*,Auto,Auto">

                        <!-- Avatar -->
                        <Frame Grid.Column="0"
                               WidthRequest="50"
                               HeightRequest="50"
                               CornerRadius="25"
                               Padding="0"
                               HasShadow="False"
                               BackgroundColor="{Binding StatusColor}">
                            <Label Text="{Binding AvatarLetter}"
                                   FontSize="20"
                                   FontAttributes="Bold"
                                   TextColor="White"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center" />
                        </Frame>

                        <!-- Friend Info -->
                        <VerticalStackLayout Grid.Column="1" Padding="10,0" VerticalOptions="Center">
                            <Label Text="{Binding DisplayName}"
                                   FontSize="16"
                                   FontAttributes="Bold" />
                            <Label Text="{Binding Username}"
                                   FontSize="14"
                                   TextColor="Gray" />
                            <Label Text="{Binding StatusText}"
                                   FontSize="12"
                                   TextColor="{Binding StatusColor}" />
                        </VerticalStackLayout>

                        <!-- Message Button -->
                        <Button Grid.Column="2"
                                Text="Чат"
                                Clicked="OnMessageFriendClicked"
                                CommandParameter="{Binding .}"
                                BackgroundColor="#2196F3"
                                TextColor="White"
                                FontSize="14"
                                WidthRequest="60"
                                HeightRequest="45"
                                CornerRadius="22"
                                Margin="5,0" />

                        <!-- Remove Button -->
                        <Button Grid.Column="3"
                                Text="✕"
                                Clicked="OnRemoveFriendClicked"
                                CommandParameter="{Binding .}"
                                BackgroundColor="#F44336"
                                TextColor="White"
                                FontSize="20"
                                WidthRequest="45"
                                HeightRequest="45"
                                CornerRadius="22"
                                Margin="5,0" />

                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>

            <CollectionView.EmptyView>
                <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center" Padding="20">
                    <Label Text="Нет друзей"
                           FontSize="18"
                           TextColor="Gray"
                           HorizontalOptions="Center" />
                    <Label Text="Добавьте друзей, введя их логин выше"
                           FontSize="14"
                           TextColor="Gray"
                           HorizontalOptions="Center"
                           Margin="0,10,0,0" />
                </VerticalStackLayout>
            </CollectionView.EmptyView>
        </CollectionView>

    </Grid>

</ContentPage>
